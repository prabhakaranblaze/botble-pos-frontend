(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function n(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(t){var o=function(t,o){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,o||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(t)}(t,"string");return"symbol"==e(o)?o:o+""}var a=function(){return n(function e(){var o,n,a;t(this,e),o=this,a=1,(n=i(n="currentZoom"))in o?Object.defineProperty(o,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[n]=a,this.init()},[{key:"init",value:function(){this.initializeSelectors(),this.bindEvents(),this.initializePreselectedValues()}},{key:"initializeSelectors",value:function(){if($.fn.select2){var e,t,o=window.BarcodeGeneratorConfig||{};$("#products-select").select2({placeholder:(null===(e=o.messages)||void 0===e?void 0:e.selectProducts)||"Select products...",allowClear:!0,width:"100%"}),$("#template-select").select2({placeholder:(null===(t=o.messages)||void 0===t?void 0:t.selectTemplate)||"Select template...",allowClear:!0,width:"100%"})}}},{key:"initializePreselectedValues",value:function(){var e=this;setTimeout(function(){e.updateProductCount(),e.updateTemplatePreview(),e.updatePreviewContainer()},100)}},{key:"bindEvents",value:function(){var e=this;$(document).on("submit","#barcode-generator-form",function(t){t.preventDefault(),e.handleFormSubmission()}),$(document).on("click","#preview-btn",function(){e.showPreview()}),$(document).on("click","#download-from-modal",function(){e.downloadFromModal()}),$(document).on("change","#template-select",function(){e.updateTemplatePreview(),e.updatePreviewContainer()}),$(document).on("change","#products-select",function(){e.updateProductCount(),e.updatePreviewContainer()}),$(document).on("change",'input[name="quantity"]',function(){e.updateEstimatedLabels(),e.updatePreviewContainer()}),$(document).on("click","#refresh-preview-btn",function(){e.refreshPreview()}),$(document).on("click","#fullscreen-preview-btn",function(){e.showPreview()}),$(document).on("click","#zoom-in-btn",function(){e.zoomPreview(1.2)}),$(document).on("click","#zoom-out-btn",function(){e.zoomPreview(.8)}),$(document).on("click","#zoom-reset-btn",function(){e.resetZoom()}),$(document).on("click","#fit-to-screen-btn",function(){e.fitToScreen()}),$(document).on("click","#print-preview-btn",function(){e.printPreview()}),$(document).on("click","#refresh-modal-preview",function(){e.refreshModalPreview()}),$("#preview-modal").on("shown.bs.modal",function(){e.onModalShown()}),$("#preview-modal").on("hidden.bs.modal",function(){e.onModalHidden()}),$(document).on("keydown",function(t){$("#preview-modal").hasClass("show")&&e.handleKeyboardShortcuts(t)}),this.initializeTooltips()}},{key:"handleFormSubmission",value:function(){var e,t=this;if(this.validateForm()){var o=window.BarcodeGeneratorConfig||{},n=$("#barcode-generator-form").serialize(),i=$('#barcode-generator-form button[type="submit"]');i.prop("disabled",!0).html('<i class="ti ti-loader-2 spin"></i> Generating...'),$.ajax({url:(null===(e=o.routes)||void 0===e?void 0:e.generate)||"/admin/barcode-generator/generate",method:"POST",data:n,success:function(e){e.error?t.showError(e.message):(t.showSuccess(e.message),e.data&&e.data.download_url&&window.open(e.data.download_url,"_blank"))},error:function(e){t.handleAjaxError(e)},complete:function(){i.prop("disabled",!1).html('<i class="ti ti-barcode"></i> Generate Labels')}})}}},{key:"showPreview",value:function(){var e;if(this.validateForm()){var t=window.BarcodeGeneratorConfig||{},o=$("#barcode-generator-form").serialize(),n=((null===(e=t.routes)||void 0===e?void 0:e.preview)||"/admin/barcode-generator/preview")+"?"+o;this.showPreviewLoading(),this.updatePreviewStats(),$("#preview-iframe").attr("src",n),$("#preview-modal").modal("show")}}},{key:"downloadFromModal",value:function(){$("#barcode-generator-form").submit(),$("#preview-modal").modal("hide")}},{key:"validateForm",value:function(){var e,t,o=window.BarcodeGeneratorConfig||{},n=$("#products-select").val(),i=$("#template-select").val();return n&&0!==n.length?!!i||(this.showError((null===(t=o.messages)||void 0===t?void 0:t.noTemplateSelected)||"Please select a template."),!1):(this.showError((null===(e=o.messages)||void 0===e?void 0:e.noProductsSelected)||"Please select at least one product."),!1)}},{key:"updateTemplatePreview",value:function(){if($("#template-select").val()){var e=$("#template-select option:selected").text();$("#template-preview").html('<p class="text-info"><i class="ti ti-check"></i> '.concat(e,"</p>"))}else $("#template-preview").html('<p class="text-muted">Select a template to see preview</p>')}},{key:"updatePreviewContainer",value:function(){var e=this,t=$("#products-select").val(),o=$("#template-select").val(),n=parseInt($('input[name="quantity"]').val())||1;if(!t||0===t.length||!o)return this.showPreviewPlaceholder(),void $("#preview-actions").addClass("d-none");this.showPreviewLoading(),setTimeout(function(){e.generateMiniPreview(t,o,n),$("#preview-actions").removeClass("d-none")},300)}},{key:"generateMiniPreview",value:function(e,t,o){var n=this,i=window.BarcodeGeneratorConfig||{},a=$("#products-select option:selected"),r=$("#template-select option:selected").text(),s=e.length*o,l='<div class="preview-summary slide-in">',c=i.ui||{};l+='<h6><svg class="icon me-2" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 5v14h18V5H3z"/><path d="M7 8v8"/><path d="M11 8v8"/><path d="M15 8v8"/></svg> '.concat(c.label_preview||"Label Preview","</h6>"),l+='<div class="preview-stats">',l+='<div class="stat-item">',l+='<span class="stat-value">'.concat(e.length,"</span>"),l+='<span class="stat-label">'.concat(c.products||"Products","</span>"),l+="</div>",l+='<div class="stat-item">',l+='<span class="stat-value">'.concat(o,"</span>"),l+='<span class="stat-label">'.concat(c.qty_each||"Qty Each","</span>"),l+="</div>",l+='<div class="stat-item">',l+='<span class="stat-value">'.concat(s,"</span>"),l+='<span class="stat-label">'.concat(c.total_labels||"Total Labels","</span>"),l+="</div>",l+="</div>",l+='<div class="mb-3">',l+='<strong><svg class="icon me-1" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M8 12h8"/><path d="M8 16h8"/><path d="M8 8h8"/></svg> '.concat(c.template||"Template",":</strong> ").concat(r),l+="</div>",l+='<div class="selected-products-list">',a.each(function(){var e=$(this).text(),t=e.split("(")[0].trim(),o=e.includes("(")?e.substring(e.indexOf("(")):"";l+='<div class="product-item">',l+='<svg class="icon me-2" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16.5 9.4L7.55 4.24C7.21 4.09 6.81 4.09 6.47 4.24L3.5 5.75C2.79 6.15 2.5 7.04 2.91 7.75L7.55 15.76C7.89 16.09 8.29 16.09 8.63 15.76L16.5 9.4Z"/><path d="M14.12 6.88L8.5 3.75L5.5 5.25"/><path d="M7.5 15.5V9.5"/></svg>',l+='<div class="product-details">',l+='<div class="product-name">'.concat(t,"</div>"),o&&(l+='<div class="product-meta">'.concat(o,"</div>")),l+="</div>",l+="</div>"}),l+="</div>",l+='<div class="preview-actions">',l+='<button type="button" id="quick-preview-btn" class="btn btn-primary btn-sm">',l+='<svg class="icon me-1" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg> '.concat(c.full_preview||"Full Preview"),l+="</button>",l+='<button type="button" id="generate-now-btn" class="btn btn-success btn-sm">',l+='<svg class="icon me-1" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7,10 12,15 17,10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> '.concat(c.generate_now||"Generate Now"),l+="</button>",l+="</div>",l+="</div>",$("#preview-container").html(l),$("#quick-preview-btn").on("click",function(){n.showPreview()}),$("#generate-now-btn").on("click",function(){$("#barcode-generator-form").submit()})}},{key:"updateProductCount",value:function(){var e=$("#products-select").val(),t=e?e.length:0;$("#selected-products-count").text(t),this.updateEstimatedLabels()}},{key:"updateEstimatedLabels",value:function(){var e=$("#products-select").val(),t=parseInt($('input[name="quantity"]').val())||1,o=(e?e.length:0)*t;$("#estimated-labels-count").text(o)}},{key:"showPreviewPlaceholder",value:function(){var e=(window.BarcodeGeneratorConfig||{}).ui||{},t='\n            <div class="preview-placeholder">\n                <div class="preview-icon">\n                    <svg class="icon-xl" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                        <path d="M3 5v14h18V5H3z"/>\n                        <path d="M7 8v8"/>\n                        <path d="M11 8v8"/>\n                        <path d="M15 8v8"/>\n                    </svg>\n                </div>\n                <h6 class="mb-2">'.concat(e.live_preview||"Live Preview",'</h6>\n                <p class="small mb-3">').concat(e.select_products_template_preview||"Select products and template to see preview",'</p>\n                <div class="preview-hint">\n                    <svg class="icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                        <circle cx="12" cy="12" r="10"/>\n                        <path d="M12 16v-4"/>\n                        <path d="M12 8h.01"/>\n                    </svg>\n                    <span>').concat(e.click_preview_details||"Click Preview to see full details","</span>\n                </div>\n            </div>\n        ");$("#preview-container").html(t)}},{key:"showPreviewLoading",value:function(){var e=(window.BarcodeGeneratorConfig||{}).ui||{},t='\n            <div class="preview-loading">\n                <div class="text-center">\n                    <div class="spinner-border text-primary mb-3" role="status">\n                        <span class="visually-hidden">'.concat(e.loading||"Loading...",'</span>\n                    </div>\n                    <p class="text-muted">').concat(e.generating_preview||"Generating preview...","</p>\n                </div>\n            </div>\n        ");$("#preview-container").html(t),$("#preview-container").addClass("loading"),setTimeout(function(){$("#preview-container").removeClass("loading")},1e3)}},{key:"refreshPreview",value:function(){this.updatePreviewContainer()}},{key:"zoomPreview",value:function(e){this.currentZoom*=e,this.currentZoom<.5&&(this.currentZoom=.5),this.currentZoom>3&&(this.currentZoom=3),$("#preview-iframe").css("transform","scale(".concat(this.currentZoom,")")),$("#zoom-level").text("".concat(Math.round(100*this.currentZoom),"%")),$("#zoom-out-btn").prop("disabled",this.currentZoom<=.5),$("#zoom-in-btn").prop("disabled",this.currentZoom>=3)}},{key:"printPreview",value:function(){var e=document.getElementById("preview-iframe");e&&e.contentWindow&&e.contentWindow.print()}},{key:"updatePreviewStats",value:function(){var e=$("#products-select").val(),t=parseInt($('input[name="quantity"]').val())||1,o=e?e.length*t:0;$("#preview-stats").text("".concat(e?e.length:0," products, ").concat(o," labels total"))}},{key:"onModalShown",value:function(){this.currentZoom=1,$("#zoom-level").text("100%"),$("#zoom-out-btn").prop("disabled",!1),$("#zoom-in-btn").prop("disabled",!1),$("#preview-iframe").on("load",function(){$("#preview-loading").addClass("d-none")})}},{key:"onModalHidden",value:function(){$("#preview-iframe").attr("src","about:blank"),$("#preview-loading").removeClass("d-none")}},{key:"resetZoom",value:function(){this.currentZoom=1,$("#preview-iframe").css("transform","scale(1)"),$("#zoom-level").text("100%"),$("#zoom-out-btn").prop("disabled",!1),$("#zoom-in-btn").prop("disabled",!1)}},{key:"fitToScreen",value:function(){var e=$(".preview-iframe-container"),t=$("#preview-iframe");if(e.length&&t.length){var o,n,i=e.width(),a=e.height(),r=i/((null===(o=t[0].contentWindow)||void 0===o||null===(o=o.document.body)||void 0===o?void 0:o.scrollWidth)||800),s=a/((null===(n=t[0].contentWindow)||void 0===n||null===(n=n.document.body)||void 0===n?void 0:n.scrollHeight)||600),l=Math.min(r,s,1);this.currentZoom=l,t.css("transform","scale(".concat(l,")")),$("#zoom-level").text("".concat(Math.round(100*l),"%")),$("#zoom-out-btn").prop("disabled",this.currentZoom<=.5),$("#zoom-in-btn").prop("disabled",this.currentZoom>=3)}}},{key:"refreshModalPreview",value:function(){var e,t=window.BarcodeGeneratorConfig||{},o=$("#barcode-generator-form").serialize(),n=((null===(e=t.routes)||void 0===e?void 0:e.preview)||"/admin/barcode-generator/preview")+"?"+o;$("#preview-loading").removeClass("d-none"),$("#preview-iframe").attr("src",n),this.updatePreviewStats()}},{key:"handleKeyboardShortcuts",value:function(e){if(e.ctrlKey||e.metaKey)switch(e.key){case"=":case"+":e.preventDefault(),this.zoomPreview(1.2);break;case"-":e.preventDefault(),this.zoomPreview(.8);break;case"0":e.preventDefault(),this.resetZoom();break;case"p":e.preventDefault(),this.printPreview()}"Escape"===e.key&&$("#preview-modal").modal("hide")}},{key:"initializeTooltips",value:function(){"undefined"!=typeof bootstrap&&bootstrap.Tooltip&&[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(e){return new bootstrap.Tooltip(e)})}},{key:"showSuccess",value:function(e){"undefined"!=typeof Botble&&Botble.showSuccess?Botble.showSuccess(e):alert(e)}},{key:"showError",value:function(e){"undefined"!=typeof Botble&&Botble.showError?Botble.showError(e):alert(e)}},{key:"handleAjaxError",value:function(e){if("undefined"!=typeof Botble&&Botble.handleError)Botble.handleError(e);else{var t=((window.BarcodeGeneratorConfig||{}).ui||{}).an_error_occurred||"An error occurred";e.responseJSON&&e.responseJSON.message&&(t=e.responseJSON.message),this.showError(t)}}}])}(),r=function(){return n(function e(){t(this,e),this.bindEvents()},[{key:"bindEvents",value:function(){var e=this;$(document).on("submit","#template-form",function(t){e.handleTemplateSubmission(t)}),$(document).on("change",'select[name="paper_size"]',function(){e.updatePaperSizeFields()}),$(document).on("change",".field-checkbox",function(){e.updateSelectedFields()})}},{key:"handleTemplateSubmission",value:function(e){}},{key:"updatePaperSizeFields",value:function(){$('select[name="paper_size"]').val()}},{key:"updateSelectedFields",value:function(){var e=[];$(".field-checkbox:checked").each(function(){e.push($(this).val())}),$('input[name="fields"]').val(JSON.stringify(e))}}])}();$(document).ready(function(){$("#barcode-generator-form").length&&new a,$("#template-form").length&&new r})})();
(()=>{function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var o,a,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function s(t,n,r,i){var s=n&&n.prototype instanceof d?n:d,l=Object.create(s.prototype);return e(l,"_invoke",function(t,e,n){var r,i,s,d=0,l=n||[],u=!1,p={p:0,n:0,v:o,a:h,f:h.bind(o,4),d:function(t,e){return r=t,i=0,s=o,p.n=e,c}};function h(t,e){for(i=t,s=e,a=0;!u&&d&&!n&&a<l.length;a++){var n,r=l[a],h=p.p,m=r[2];t>3?(n=m===e)&&(s=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=o):r[0]<=h&&((n=t<2&&h<r[1])?(i=0,p.v=e,p.n=r[1]):h<m&&(n=t<3||r[0]>e||e>m)&&(r[4]=t,r[5]=e,p.n=m,i=0))}if(n||t>1)return c;throw u=!0,e}return function(n,l,m){if(d>1)throw TypeError("Generator is already running");for(u&&1===l&&h(l,m),i=l,s=m;(a=i<2?o:s)||!u;){r||(i?i<3?(i>1&&(p.n=-1),h(i,s)):p.n=s:p.v=s);try{if(d=2,r){if(i||(n="next"),a=r[n]){if(!(a=a.call(r,s)))throw TypeError("iterator result is not an object");if(!a.done)return a;s=a.value,i<2&&(i=0)}else 1===i&&(a=r.return)&&a.call(r),i<2&&(s=TypeError("The iterator does not provide a '"+n+"' method"),i=1);r=o}else if((a=(u=p.n<0)?s:t.call(e,p))!==c)break}catch(t){r=o,i=1,s=t}finally{d=1}}return{value:a,done:u}}}(t,r,i),!0),l}var c={};function d(){}function l(){}function u(){}a=Object.getPrototypeOf;var p=[][r]?a(a([][r]())):(e(a={},r,function(){return this}),a),h=u.prototype=d.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,e(t,i,"GeneratorFunction")),t.prototype=Object.create(h),t}return l.prototype=u,e(h,"constructor",u),e(u,"constructor",l),l.displayName="GeneratorFunction",e(u,i,"GeneratorFunction"),e(h),e(h,i,"Generator"),e(h,r,function(){return this}),e(h,"toString",function(){return"[object Generator]"}),(t=function(){return{w:s,m}})()}function e(t,o,a,n){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}e=function(t,o,a,n){function i(o,a){e(t,o,function(t){return this._invoke(o,a,t)})}o?r?r(t,o,{value:a,enumerable:!n,configurable:!n,writable:!n}):t[o]=a:(i("next",0),i("throw",1),i("return",2))},e(t,o,a,n)}function o(t,e,o,a,n,r,i){try{var s=t[r](i),c=s.value}catch(t){return void o(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function a(t){return function(){var e=this,a=arguments;return new Promise(function(n,r){var i=t.apply(e,a);function s(t){o(i,n,r,s,c,"next",t)}function c(t){o(i,n,r,s,c,"throw",t)}s(void 0)})}}function n(t){return window.trans&&window.trans[t]?window.trans[t]:t}$(document).ready(function(){$('[data-bs-toggle="tooltip"]').tooltip({placement:"top",trigger:"hover",boundary:"window"}),void 0!==window.BarcodeScanner&&(window.BarcodeScanner.init({containerId:"barcode-scanner-container",checkCameraOnInit:!1,onDetected:function(t){Botble.showSuccess(n("plugins/pos-pro::pos.barcode_detected").replace(":barcode",t));var e=$("#pos-container").data("scan-barcode-url");e?$httpClient.make().post(e,{barcode:t}).then(function(e){e.error?($("#search-product").val(t),$("#search-product").trigger("keyup"),Botble.showError(e.message||"Product not found")):e.data.auto_added?(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Product added to cart")):e.data.has_variations&&($("#search-product").val(t),$("#search-product").trigger("keyup"),Botble.showInfo(e.data.message||"Product found - please select variation"))}).catch(function(e){$("#search-product").val(t),$("#search-product").trigger("keyup"),console.error("Barcode scan API error:",e)}):($("#search-product").val(t),$("#search-product").trigger("keyup")),$("#barcode-scanner-container").slideUp(300),window.BarcodeScanner.stopScan()}}),$("#toggle-barcode-scanner").on("click",a(t().m(function e(){var o,a,r,i,s;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!(o=$("#barcode-scanner-container")).is(":visible")){t.n=1;break}o.slideUp(300),window.BarcodeScanner&&window.BarcodeScanner.stopScan().catch(function(t){console.error("Error stopping barcode scanner:",t)}),t.n=5;break;case 1:if(a=$(this),r=a.html(),a.prop("disabled",!0).html('<i class="spinner-border spinner-border-sm"></i>'),window.BarcodeScanner){t.n=2;break}return console.error("Barcode scanner not initialized"),Botble.showError(n("plugins/pos-pro::pos.scanner_not_available")),a.prop("disabled",!1).html(r),t.a(2);case 2:return t.p=2,t.n=3,window.BarcodeScanner.checkCameraPermission();case 3:i=t.v,a.prop("disabled",!1).html(r),o.slideDown(300),i&&window.BarcodeScanner.startScan().catch(function(t){console.error("Error starting barcode scanner:",t),"Camera permission denied"===t.message?Botble.showError(n("plugins/pos-pro::pos.camera_permission_denied")):Botble.showError(n("plugins/pos-pro::pos.no_camera_access"))}),t.n=5;break;case 4:t.p=4,s=t.v,a.prop("disabled",!1).html(r),console.error("Error checking camera permission:",s),Botble.showError(n("plugins/pos-pro::pos.no_camera_access")),o.slideDown(300);case 5:return t.a(2)}},e,this,[[2,4]])}))));var e=$("#fullscreen-toggle"),o=$("#fullscreen-toggle-mobile"),r=$("#fullscreen-icon"),i=$("#fullscreen-text"),s=$("#fullscreen-text-mobile"),c=$(".pos-container"),d=$("#exit-fullscreen-floating"),l=$("#mobile-menu-offcanvas"),u=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled,p=function(t){t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()},h=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},m=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)},v=e.data("fullscreen-text"),w=e.data("exit-fullscreen-text"),f=function(t){if(t){c.addClass("fullscreen-mode"),r.removeClass("ti-maximize").addClass("ti-minimize"),i.text(w),s.text(w),d.fadeIn(300).css("display","inline-flex");var e=bootstrap.Offcanvas.getInstance(l[0]);e&&e.hide()}else c.removeClass("fullscreen-mode"),r.removeClass("ti-minimize").addClass("ti-maximize"),i.text(v),s.text(v),d.fadeOut(200)};e.on("click",function(){if(u)m()?h():p(document.documentElement);else{var t=c.hasClass("fullscreen-mode");f(!t)}}),o.on("click",function(){var t=bootstrap.Offcanvas.getInstance(l[0]);t&&t.hide(),setTimeout(function(){if(u)m()?h():p(document.documentElement);else{var t=c.hasClass("fullscreen-mode");f(!t)}},300)}),d.on("click",function(){m()?h():f(!1)}),document.addEventListener("fullscreenchange",function(){f(m())}),document.addEventListener("webkitfullscreenchange",function(){f(m())}),document.addEventListener("mozfullscreenchange",function(){f(m())}),document.addEventListener("MSFullscreenChange",function(){f(m())}),$(document).on("keydown",function(t){"F11"!==t.key&&122!==t.keyCode||(t.preventDefault(),e.trigger("click"))});var g=$("#pos-container"),b={cartAdd:g.data("cart-add-url"),cartUpdate:g.data("cart-update-url"),cartRemove:g.data("cart-remove-url"),cartClear:g.data("cart-clear-url"),cartApplyCoupon:g.data("cart-apply-coupon-url"),cartRemoveCoupon:g.data("cart-remove-coupon-url"),cartUpdateShipping:g.data("cart-update-shipping-url"),cartUpdateManualDiscount:g.data("cart-update-manual-discount-url"),cartRemoveManualDiscount:g.data("cart-remove-manual-discount-url"),products:g.data("products-url"),quickShop:g.data("quick-shop-url"),checkout:g.data("checkout-url"),receipt:g.data("receipt-url"),orderSlots:g.data("order-slots-url"),orderSlotsCreate:g.data("order-slots-create-url"),orderSlotsSwitch:g.data("order-slots-switch-url"),orderSlotsClose:g.data("order-slots-close-url")},k=new BroadcastChannel("pos_channel");window.updateCartDisplay=function(t){if(t){$("#cart-items").html(t.html||"");var e=$("#clear-cart");e.length&&(t.count>0?e.prop("disabled",!1):e.prop("disabled",!0)),D(t),$('[data-bs-toggle="tooltip"]').tooltip({placement:"top",trigger:"hover",boundary:"window"}),t.customer_id&&t.customer?($("#customer-id").val(t.customer_id),$("#selected-customer-name").text(t.customer.name),$("#selected-customer-contact").html("<span>".concat(t.customer.phone||"","</span>").concat(t.customer.email?" • <span>".concat(t.customer.email,"</span>"):"")),$("#selected-customer-info").removeClass("d-none"),$("#customer-search").val(t.customer.name)):($("#customer-id").val(""),$("#selected-customer-info").addClass("d-none"),$("#customer-search").val("")),t.payment_method?$('input[name="payment_method"][value="'.concat(t.payment_method,'"]')).prop("checked",!0):$('input[name="payment_method"][value="cash"]').prop("checked",!0),t.count||0?$("#checkout-button").prop("disabled",!1).removeClass("disabled"):$("#checkout-button").prop("disabled",!0).addClass("disabled"),window.initialCart=t}else console.error("Cart data is undefined or null")},window.initialCart&&window.updateCartDisplay(window.initialCart);var C,x,y=$("#search-product"),_=$("#search-icon-addon"),B=$("#search-icon");function E(t){var e=S();$httpClient.make().post(e.cartUpdateCustomer,{customer_id:t}).then(function(t){t.error&&Botble.showError(t.message)}).catch(function(t){console.error("Error saving customer to session:",t)})}function S(){var t=$("#pos-container");return{cartAdd:t.data("cart-add-url"),cartUpdate:t.data("cart-update-url"),cartRemove:t.data("cart-remove-url"),cartClear:t.data("cart-clear-url"),cartApplyCoupon:t.data("cart-apply-coupon-url"),cartRemoveCoupon:t.data("cart-remove-coupon-url"),cartUpdateShipping:t.data("cart-update-shipping-url"),cartUpdateManualDiscount:t.data("cart-update-manual-discount-url"),cartRemoveManualDiscount:t.data("cart-remove-manual-discount-url"),cartUpdateCustomer:t.data("cart-update-customer-url"),cartUpdatePaymentMethod:t.data("cart-update-payment-method-url"),products:t.data("products-url"),quickShop:t.data("quick-shop-url"),checkout:t.data("checkout-url"),receipt:t.data("receipt-url")}}function M(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=$("#customer-search-results");$.ajax({url:g.data("search-customers-url")||route("pos-pro.search-customers"),method:"GET",data:{q:t},beforeSend:function(){e.html('<div class="dropdown-item text-center"><div class="spinner-border spinner-border-sm text-primary" role="status"></div></div>')},success:function(t){if(t.data&&t.data.results){if(0===t.data.results.length)return void e.html('<div class="dropdown-item text-center text-muted">No customers found</div>');var o="";t.data.results.forEach(function(t){o+='<a href="javascript:void(0)" class="dropdown-item customer-search-item"\n                                    data-id="'.concat(t.id,'"\n                                    data-name="').concat(t.text,'"\n                                    data-phone="').concat(t.phone||"",'"\n                                    data-email="').concat(t.email||"",'">\n                                    <div class="d-flex align-items-center">\n                                        <div class="me-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" /><path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" /></svg></div>\n                                        <div>\n                                            <div class="fw-medium">').concat(t.name,'</div>\n                                            <div class="text-muted small">').concat(t.phone||""," ").concat(t.email?"• "+t.email:"","</div>\n                                        </div>\n                                    </div>\n                                </a>")}),e.html(o)}else e.html('<div class="dropdown-item text-center text-muted">Error loading customers</div>')},error:function(){e.html('<div class="dropdown-item text-center text-danger">Error loading customers</div>')}})}function D(t){if(t){var e=(t.items||[]).map(function(t){return{id:t.id,name:t.name,price:parseFloat(t.price)||0,qty:t.quantity||t.qty||1,image:t.image_url||t.image||null,tax_rate:parseFloat(t.tax_rate)||0}}),o=(parseFloat(t.coupon_discount)||0)+(parseFloat(t.manual_discount)||0);k.postMessage({type:"UPDATE_CART",cart:e,discount:o,shipping:parseFloat(t.shipping_amount)||0})}}function F(){var t=$('input[name="delivery_option"]:checked').val(),e=$("#customer-address-section"),o=$("#delivery-option-help");"pickup"===t?(e.hide(),o.text(n("plugins/pos-pro::pos.pickup_in_store_help"))):(e.show(),o.text(n("plugins/pos-pro::pos.ship_to_address_help")))}function j(t){var e=window.currencySymbol||"$",o=!1!==window.currencyIsPrefix,a=(new Intl.NumberFormat).format(t);return o?e+a:a+e}function q(t,e){var o=t-e,a=$("#change-amount"),n=$("#change-status");0===t||""===t?(a.text(j(0)),a.removeClass("text-success text-danger").addClass("text-muted"),n.addClass("d-none")):o>=0?(a.text(j(o)),a.removeClass("text-muted text-danger").addClass("text-success"),n.addClass("d-none")):(a.text("-"+j(Math.abs(o))),a.removeClass("text-muted text-success").addClass("text-danger"),n.removeClass("d-none"))}y.val().length>0&&(B.html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>'),_.css("cursor","pointer")),$(document).on("click","#confirm-add-customer-button",function(t){t.preventDefault();var e=$(this),o=$("#add-customer-modal"),a=$("#customer-name").val(),n=$("#customer-email").val(),r=$("#customer-phone").val(),i=$("#customer-address").val(),s=!1;if($(".add-customer-form .is-invalid").removeClass("is-invalid"),a||($("#customer-name").addClass("is-invalid"),s=!0),r||($("#customer-phone").addClass("is-invalid"),s=!0),!s){var c=g.data("create-customer-url");$httpClient.make().withButtonLoading(e[0]).post(c,{name:a,email:n,phone:r,address:i}).then(function(t){var e=t.data;if(e.error)Botble.showError(e.message);else{var a=e.data.customer.id,n=e.data.customer.name,r=e.data.customer.phone,i=e.data.customer.email||"";$("#customer-id").val(a),$("#selected-customer-name").text(n),$("#selected-customer-contact").html("<span>".concat(r,"</span>").concat(i?" • <span>".concat(i,"</span>"):"")),$("#selected-customer-info").removeClass("d-none"),$("#customer-name").val(""),$("#customer-email").val(""),$("#customer-phone").val(""),$("#customer-address").val(""),bootstrap.Modal.getInstance(o[0]).hide(),Botble.showSuccess(e.message)}}).catch(function(t){Botble.handleError(t)})}}),$("#search-product").on("keyup",function(){var t=$(this),e=$("#search-icon-addon"),o=$("#search-icon"),a=t.val();a.length>0?0!==o.find("svg").length&&"x"===o.data("icon")||(o.html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>'),o.data("icon","x"),e.css("cursor","pointer")):"x"===o.data("icon")&&(o.html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>'),o.data("icon","search"),e.css("cursor","default")),clearTimeout(C),C=setTimeout(function(){z=1,P=!0,L(a,1,!1)},500)}),$(document).on("click","#search-icon-addon",function(){var t=$("#search-icon"),e=$("#search-product");"x"===t.data("icon")&&(e.val("").focus(),t.html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>'),t.data("icon","search"),$(this).css("cursor","default"),z=1,P=!0,L("",1,!1))}),$(document).on("click","#clear-search",function(){$("#search-product").val("").focus(),z=1,P=!0,L("",1,!1)}),$(document).on("keyup focus","#customer-search",function(){var t=$(this),e=$("#customer-search-results"),o=t.val().trim();clearTimeout(x),e.show(),x=setTimeout(function(){0===o.length?M(""):o.length>=1&&M(o)},300)}),$(document).on("click",function(t){$(t.target).closest("#customer-search, #customer-search-results").length||$("#customer-search-results").hide()}),$(document).on("click","#remove-selected-customer",function(){$("#customer-id").val(""),$("#selected-customer-info").addClass("d-none"),$("#customer-search").val("").focus(),E("")}),$(document).on("click",".customer-search-item",function(){var t=$(this).data("id"),e=$(this).data("name"),o=$(this).data("phone"),a=$(this).data("email");$("#customer-id").val(t),$("#selected-customer-name").text(e),$("#selected-customer-contact").html("<span>".concat(o,"</span>").concat(a?" • <span>".concat(a,"</span>"):"")),$("#selected-customer-info").removeClass("d-none"),$("#customer-search-results").hide(),$("#customer-search").val(""),E(t)}),window.clearCustomerDisplay=function(){k.postMessage({type:"CLEAR"})},$(document).on("click","#open-customer-display, #open-customer-display-mobile",function(t){t.preventDefault();var e=$(this).data("customer-display-url");console.log("Customer Display URL:",e),e&&window.open(e,"CustomerDisplay","width=1024,height=768,scrollbars=no,resizable=yes")}),$(document).on("click",".order-slot-tab",function(t){if(!$(t.target).closest(".close-order-slot").length){var e=$(this).data("slot");e&&b.orderSlotsSwitch&&$.ajax({url:b.orderSlotsSwitch,method:"POST",data:{slot:e},success:function(t){t.error?Botble.showError(t.message):(window.updateCartDisplay(t.data.cart),D(t.data.cart))},error:function(t){Botble.handleError(t)}})}}),$(document).on("click",".add-order-slot",function(t){t.preventDefault(),b.orderSlotsCreate&&$.ajax({url:b.orderSlotsCreate,method:"POST",success:function(t){t.error?Botble.showError(t.message):(window.updateCartDisplay(t.data.cart),Botble.showSuccess(t.message),"function"==typeof window.clearCustomerDisplay&&window.clearCustomerDisplay())},error:function(t){Botble.handleError(t)}})}),$(document).on("click",".close-order-slot",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).data("slot");if(e&&b.orderSlotsClose){var o=window.trans&&window.trans["plugins/pos-pro::pos.confirm_close_order"]?window.trans["plugins/pos-pro::pos.confirm_close_order"]:"Are you sure you want to close this order?";confirm(o)&&$.ajax({url:b.orderSlotsClose,method:"POST",data:{slot:e},success:function(t){t.error?Botble.showError(t.message):(window.updateCartDisplay(t.data.cart),Botble.showSuccess(t.message),D(t.data.cart))},error:function(t){Botble.handleError(t)}})}}),$(window).on("scroll",function(){P&&!O&&$("#products-grid").length&&($(window).scrollTop()+$(window).height()>=$(document).height()-200&&L(T,z,!0))}),$(document).on("click","#apply-coupon-btn",function(){var t=$(this),e=$("#coupon-modal"),o=$("#coupon-code-input").val().trim(),a=$("#coupon-error-msg");if(!o)return a.text(n("plugins/pos-pro::pos.please_enter_coupon_code")),void $("#coupon-code-input").addClass("is-invalid");$httpClient.make().withButtonLoading(t[0]).post(b.cartApplyCoupon,{coupon_code:o}).then(function(t){var o=t.data;if(o.error)return a.text(o.message),void $("#coupon-code-input").addClass("is-invalid");window.updateCartDisplay(o.data.cart),Botble.showSuccess(o.message),e.modal("hide"),$("#coupon-code-input").removeClass("is-invalid")}).catch(function(t){Botble.handleError(t)})}),$(document).on("click","#remove-coupon-btn",function(){var t=$(this),e=$("#coupon-modal");$httpClient.make().withButtonLoading(t[0]).post(b.cartRemoveCoupon).then(function(t){var o=t.data;o.error?Botble.showError(o.message):(window.updateCartDisplay(o.data.cart),Botble.showSuccess(o.message),e.modal("hide"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("keypress",".coupon-code",function(t){13===t.which&&(t.preventDefault(),$(this).closest(".coupon-form").find(".apply-coupon-code").click())}),$(document).on("keypress","#coupon-code-input",function(t){13===t.which&&(t.preventDefault(),$("#apply-coupon-btn").click())}),$("#coupon-modal").on("show.bs.modal",function(){$(this);var t=$("#coupon-code-input"),e=$("#coupon-error-msg");window.initialCart&&window.initialCart.coupon_code?t.val(window.initialCart.coupon_code):t.val(""),t.removeClass("is-invalid"),e.text("")}),$(document).on("click","#update-shipping",function(){var t=$(this),e=$("#shipping-amount").val();$httpClient.make().withButtonLoading(t[0]).post(b.cartUpdateShipping,{shipping_amount:e}).then(function(t){var e=t.data;e.error?Botble.showError(e.message):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.message))}).catch(function(t){Botble.handleError(t)})}),$(document).on("keypress","#shipping-amount",function(t){13===t.which&&(t.preventDefault(),$("#update-shipping").click())}),$(document).on("click","#update-shipping",function(){var t=$(this),e=parseFloat($("#shipping-amount").val())||0;$httpClient.make().withButtonLoading(t[0]).post(b.cartUpdateShipping,{shipping_amount:e}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.message||"Shipping amount updated successfully"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("click","#update-shipping-btn",function(){var t=$(this),e=$("#shipping-modal"),o=parseFloat($("#shipping-amount-input").val())||0,a=$("#shipping-error-msg");if(o<0)return a.text(n("plugins/pos-pro::pos.invalid_shipping_amount")),void $("#shipping-amount-input").addClass("is-invalid");a.text(""),$("#shipping-amount-input").removeClass("is-invalid"),$httpClient.make().withButtonLoading(t[0]).post(b.cartUpdateShipping,{shipping_amount:o}).then(function(t){var o=t.data;if(o.error)return a.text(o.message),void $("#shipping-amount-input").addClass("is-invalid");window.updateCartDisplay(o.data.cart),Botble.showSuccess(o.message),e.modal("hide")}).catch(function(t){Botble.handleError(t)})}),$(document).on("keypress","#shipping-amount-input",function(t){13===t.which&&(t.preventDefault(),$("#update-shipping-btn").click())}),$("#shipping-modal").on("show.bs.modal",function(){$(this);var t=$("#shipping-amount-input"),e=$("#shipping-error-msg");window.initialCart?t.val(window.initialCart.shipping_amount||0):t.val(0),t.removeClass("is-invalid"),e.text("")}),$(document).on("change",'input[name="discount-type"]',function(){"percentage"===$('input[name="discount-type"]:checked').val()?$("#discount-symbol").text("%"):$("#discount-symbol").text(window.currency||"$")}),$(document).on("click","#apply-discount-btn",function(){var t=$(this),e=$("#discount-modal"),o=$("#discount-amount-input").val(),a=$("#discount-description-input").val(),r=$('input[name="discount-type"]:checked').val(),i=$("#discount-error-msg");return!o||parseFloat(o)<=0?(i.text(n("plugins/pos-pro::pos.invalid_discount_amount")),void $("#discount-amount-input").addClass("is-invalid")):"percentage"===r&&parseFloat(o)>100?(i.text(n("plugins/pos-pro::pos.percentage_discount_cannot_exceed_100")),void $("#discount-amount-input").addClass("is-invalid")):(i.text(""),$("#discount-amount-input").removeClass("is-invalid"),void $httpClient.make().withButtonLoading(t[0]).post(b.cartUpdateManualDiscount,{discount_amount:o,discount_description:a,discount_type:r}).then(function(t){var o=t.data;if(o.error)return i.text(o.message),void $("#discount-amount-input").addClass("is-invalid");window.updateCartDisplay(o.data.cart),Botble.showSuccess(o.message),e.modal("hide")}).catch(function(t){Botble.handleError(t)}))}),$(document).on("click","#remove-discount-btn",function(){var t=$(this),e=$("#discount-modal");$httpClient.make().withButtonLoading(t[0]).post(b.cartRemoveManualDiscount).then(function(t){var o=t.data;o.error?Botble.showError(o.message):(window.updateCartDisplay(o.data.cart),Botble.showSuccess(o.message),e.modal("hide"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("keypress","#discount-amount-input",function(t){13===t.which&&(t.preventDefault(),$("#apply-discount-btn").click())}),$("#discount-modal").on("show.bs.modal",function(){$(this);var t=$("#discount-amount-input"),e=$("#discount-description-input"),o=$("#discount-error-msg");if(window.initialCart&&window.initialCart.manual_discount>0){var a=window.initialCart.manual_discount_type||"fixed";$('input[name="discount-type"][value="'.concat(a,'"]')).prop("checked",!0).trigger("change"),t.val(window.initialCart.manual_discount_value),e.val(window.initialCart.manual_discount_description||"")}else t.val(""),e.val(""),$('input[name="discount-type"][value="fixed"]').prop("checked",!0).trigger("change");t.removeClass("is-invalid"),o.text("")}),$(document).on("click",".add-to-cart",function(){var t=$(this),e=t.data("product-id"),o=!0===t.data("has-variations"),a=t.data("url");if(o){var n=b.quickShop.replace(":id",e);$httpClient.make().withButtonLoading(t[0]).get(n).then(function(t){var e,o=t.data;$("#quick-shop-modal .modal-content").html((null===(e=o.data)||void 0===e?void 0:e.html)||o.html||""),$("#quick-shop-modal").modal("show")}).catch(function(t){Botble.handleError(t)})}else $httpClient.make().withButtonLoading(t[0]).post(a,{product_id:e,quantity:1}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Product added to cart"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("click",".update-quantity",function(t){t.preventDefault(),t.stopPropagation();var e=$(this),o=e.data("product-id"),a=e.data("quantity");if(!(a<1)){var n=b.cartUpdate;$httpClient.make().withButtonLoading(e[0]).post(n,{product_id:o,quantity:a}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Cart updated successfully"))}).catch(function(t){Botble.handleError(t)})}}),$(document).on("input",'.cart-item input[type="text"]',function(){this.value=this.value.replace(/[^0-9]/g,""),this.value&&!isNaN(parseInt(this.value,10))&&$(this).data("last-value",this.value)}),$(document).on("click",".remove-from-cart",function(t){t.preventDefault(),t.stopPropagation();var e=$(this),o=e.data("product-id"),a=b.cartRemove;$httpClient.make().withButtonLoading(e[0]).post(a,{product_id:o}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Item removed from cart"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("click","#clear-cart",function(){new bootstrap.Modal(document.getElementById("clear-cart-modal")).show()}),$(document).on("click","#confirm-clear-cart-btn",function(){var t=$(this),e=b.cartClear,o=bootstrap.Modal.getInstance(document.getElementById("clear-cart-modal"));$httpClient.make().withButtonLoading(t[0]).post(e).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):(window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Cart cleared successfully"),o&&o.hide())}).catch(function(t){Botble.handleError(t)})}),$(document).on("submit","#quick-shop-form",function(t){t.preventDefault();var e=$(this),o=e.find('button[type="submit"]'),a=b.cartAdd,n=e.find('input[name="product_id"]').val(),r=e.find('input[name="quantity"]').val()||1,i=[];e.find("select.variation-select").each(function(){var t=$(this).data("attribute-id"),e=$(this).val();e&&t&&(i[t]=e)}),e.find('input[type="radio"]:checked').each(function(){var t=$(this).data("attribute-id"),e=$(this).val();e&&t&&(i[t]=e)}),$httpClient.make().withButtonLoading(o[0]).post(a,{product_id:n,quantity:r,attributes:i}).then(function(t){var e=t.data;e.error?Botble.showError(e.message||"An error occurred"):($("#quick-shop-modal").modal("hide"),window.updateCartDisplay(e.data.cart),Botble.showSuccess(e.data.message||"Product added to cart"))}).catch(function(t){Botble.handleError(t)})}),$(document).on("change",'#cart-items input[name="payment_method"]',function(){var t=$(this).val();window.selectedPaymentMethod=t,function(t){var e=S();$httpClient.make().post(e.cartUpdatePaymentMethod,{payment_method:t}).then(function(t){t.error&&Botble.showError(t.message)}).catch(function(t){console.error("Error saving payment method to session:",t)})}(t)}),$(document).on("click","#checkout-button",function(t){t.preventDefault(),t.stopPropagation();var e=$('input[name="payment_method"]:checked').val()||"cash",o=$('input[name="payment_method"]:checked').closest(".form-selectgroup-item").find(".form-selectgroup-title").text()||n("plugins/pos-pro::pos.cash"),a="cash"===e?"ti-cash":"card"===e?"ti-credit-card":"ti-wallet";$("#checkout-payment-method").val(e),$("#checkout-payment-method-info").html('<x-core::icon name="'.concat(a,'" class="me-1" /> ').concat(o));var r=$("#customer-id").val(),i=n("plugins/pos-pro::pos.guest"),s="",c="",d="";if(r&&$("#selected-customer-name").text()){i=$("#selected-customer-name").text(),s=$("#selected-customer-name").text();var l=$("#selected-customer-contact").text();if(l){var u=l.split("•");u.length>0&&(c=u[0].trim()),u.length>1&&(d=u[1].trim())}$("#checkout-customer-id").val(r),$("#checkout-customer-name").length?($("#checkout-customer-name").val(s),$("#checkout-customer-phone").val(c),$("#checkout-customer-email").val(d)):($("#checkout-form").append('<input type="hidden" id="checkout-customer-name" name="customer_name" value="'.concat(s,'">')),$("#checkout-form").append('<input type="hidden" id="checkout-customer-phone" name="customer_phone" value="'.concat(c,'">')),$("#checkout-form").append('<input type="hidden" id="checkout-customer-email" name="customer_email" value="'.concat(d,'">')))}else $("#checkout-customer-id").val(""),$("#checkout-customer-name, #checkout-customer-phone, #checkout-customer-email").remove();if($("#checkout-customer-info").text(i),function(t){var e=$("#address-form-container");e.html('\n            <div class="text-center py-3">\n                <div class="spinner-border spinner-border-sm text-primary" role="status">\n                    <span class="visually-hidden">'.concat(n("plugins/pos-pro::pos.loading"),'...</span>\n                </div>\n                <div class="mt-2 text-muted">').concat(n("plugins/pos-pro::pos.loading_address_form"),"</div>\n            </div>\n        "));var o=g.data("address-form-url")||"/admin/pos/address-form";$.ajax({url:o,method:"GET",data:{customer_id:t},success:function(t){t&&t.data&&t.data.html?e.html(t.data.html):e.html('\n                        <div class="alert alert-warning">\n                            <div class="text-muted">'.concat(n("plugins/pos-pro::pos.address_form_load_error"),"</div>\n                        </div>\n                    "))},error:function(){e.html('\n                    <div class="alert alert-danger">\n                        <div class="text-danger">'.concat(n("plugins/pos-pro::pos.address_form_load_error"),"</div>\n                    </div>\n                "))}})}(r),F(),window.initialCart){$("#modal-subtotal").text(window.initialCart.subtotal_formatted),$("#modal-tax").text(window.initialCart.tax_formatted),$("#modal-shipping").text(window.initialCart.shipping_amount_formatted),$("#modal-total").text(window.initialCart.total_formatted);var p=window.initialCart.coupon_discount&&window.initialCart.coupon_discount>0,h=$("#checkout-modal .datagrid-item.coupon-discount-row");if(p)if(0===h.length){var m=window.initialCart.coupon_code||"",v=m?'<span class="badge bg-blue-lt ms-1">'.concat(m,"</span>"):"",w='\n                        <div class="datagrid-item coupon-discount-row">\n                            <div class="datagrid-title">\n                                <div class="d-flex align-items-center">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1 text-primary"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 7.2a3 3 0 0 1 6 -2.2h2a3 3 0 0 1 6 2.2v1.8a1 1 0 0 1 -.883 .993l-.117 .007h-2v7a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1v-7h-2a1 1 0 0 1 -1 -1v-1.8z" /><path d="M9 12l2 2l4 -4" /></svg>\n                                    '.concat(n("plugins/pos-pro::pos.coupon_discount"),"\n                                    ").concat(v,'\n                                </div>\n                            </div>\n                            <div class="datagrid-content text-danger">-').concat(window.initialCart.coupon_discount_formatted,"</div>\n                        </div>\n                    ");$("#checkout-modal .datagrid-item:last").before(w)}else h.find(".datagrid-content").text("-"+window.initialCart.coupon_discount_formatted);else h.remove();var f=window.initialCart.manual_discount&&window.initialCart.manual_discount>0,b=$("#checkout-modal .datagrid-item.manual-discount-row");if(f)if(0===b.length){var k=window.initialCart.manual_discount_description||"",C=k?'<span class="badge bg-blue-lt ms-1" title="'.concat(k,'">').concat(k.length>15?k.substring(0,15)+"...":k,"</span>"):"",x='\n                        <div class="datagrid-item manual-discount-row">\n                            <div class="datagrid-title">\n                                <div class="d-flex align-items-center">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1 text-primary"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 5h6a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2v-2a2 2 0 0 1 2 -2" /><path d="M9 13h6a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2v-2a2 2 0 0 1 2 -2" /><path d="M9 7l8 10" /></svg>\n                                    '.concat(n("plugins/pos-pro::pos.manual_discount"),"\n                                    ").concat(C,'\n                                </div>\n                            </div>\n                            <div class="datagrid-content text-danger">-').concat(window.initialCart.manual_discount_formatted,"</div>\n                        </div>\n                    ");$("#checkout-modal .datagrid-item:last").before(x)}else b.find(".datagrid-content").text("-"+window.initialCart.manual_discount_formatted);else b.remove()}$("#checkout-modal").modal("show"),function(){var t=$("#checkout-payment-method").val()||"cash",e=window.initialCart?window.initialCart.total:0;"cash"===t?$("#cash-payment-section").show():$("#cash-payment-section").hide();$("#cash-received-input").val(""),q(0,e),function(t){var e=$("#quick-cash-buttons");e.empty();var o=window.trans&&window.trans["plugins/pos-pro::pos.exact"]?window.trans["plugins/pos-pro::pos.exact"]:"Exact";e.append('<button type="button" class="btn btn-outline-success quick-cash-btn" data-amount="exact">'.concat(o,"</button>"));var a=function(t){var e=[];if(t<=0)return e;for(var o=[10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5,2e5,5e5],a=0;a<o.length&&e.length<4;a++)o[a]>=t&&!e.includes(o[a])&&e.push(o[a]);if(e.length<2){var n=10*Math.ceil(t/10);!e.includes(n)&&n>t&&e.unshift(n)}return e.slice(0,4)}(t);a.forEach(function(t){var o=j(t);e.append('<button type="button" class="btn btn-outline-secondary quick-cash-btn" data-amount="'.concat(t,'">').concat(o,"</button>"))})}(e)}()}),$(document).on("input","#cash-received-input",function(){q(parseFloat($(this).val())||0,window.initialCart?window.initialCart.total:0)}),$(document).on("click",".quick-cash-btn",function(){var t=$(this).data("amount"),e=window.initialCart?window.initialCart.total:0;"exact"===t?($("#cash-received-input").val(e.toFixed(2)),q(e,e)):($("#cash-received-input").val(parseFloat(t).toFixed(2)),q(parseFloat(t),e))}),$(document).on("change",'#cart-items input[name="payment_method"]',function(){var t=$(this).val();$("#checkout-payment-method").val(t);var e={cash:window.trans&&window.trans["plugins/pos-pro::pos.cash"]?window.trans["plugins/pos-pro::pos.cash"]:"Cash",card:window.trans&&window.trans["plugins/pos-pro::pos.card"]?window.trans["plugins/pos-pro::pos.card"]:"Card",other:window.trans&&window.trans["plugins/pos-pro::pos.other"]?window.trans["plugins/pos-pro::pos.other"]:"Other"};$("#checkout-payment-method-info").html({cash:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1 text-success"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 9v-2a2 2 0 0 0 -2 -2h-10a2 2 0 0 0 -2 2v6a2 2 0 0 0 2 2h2" /><path d="M13 9h8a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2v-6a2 2 0 0 1 2 -2z" /><path d="M17 14a1 1 0 1 0 2 0a1 1 0 0 0 -2 0" /></svg>',card:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1 text-info"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 5m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z" /><path d="M3 10l18 0" /><path d="M7 15l.01 0" /><path d="M11 15l2 0" /></svg>',other:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1 text-warning"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 8v-3a1 1 0 0 0 -1 -1h-10a2 2 0 0 0 0 4h12a1 1 0 0 1 1 1v3m0 4v3a1 1 0 0 1 -1 1h-12a2 2 0 0 1 -2 -2v-12" /><path d="M20 12v4h-4a2 2 0 0 1 0 -4h4" /></svg>'}[t]+e[t]),"cash"===t?$("#cash-payment-section").show():$("#cash-payment-section").hide()}),$(document).on("change",'input[name="delivery_option"]',function(){F()}),$(document).on("click","#complete-order-btn",function(){var t=$(this),e=$("#checkout-form");Botble.showButtonLoading(t[0]),$.ajax({url:b.checkout,method:"POST",data:e.serializeArray(),success:function(t){if(t.error)Botble.showError(t.message);else{if($("#checkout-modal").modal("hide"),Botble.showSuccess(t.message),t.data.order_ids&&t.data.order_ids.length>1){var e=t.data.orders?t.data.orders.map(function(t){return t.code}).join(", "):t.data.order_code;$("#order-number").text(e),$("#multiple-orders-info").removeClass("d-none"),$("#print-receipt-btn").data("order-ids",t.data.order_ids.join(","))}else $("#order-number").text(t.data.order_code||t.data.order.code),$("#multiple-orders-info").addClass("d-none"),$("#print-receipt-btn").data("order-ids",t.data.order_id||t.data.order.id);$("#success-modal").modal("show")}},error:function(t){Botble.handleError(t)},complete:function(){Botble.hideButtonLoading(t[0])}})});var z=1,P=!0,O=!1,T="";function L(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!O&&b.products){O=!0,T=t;var a=$httpClient.make();e>1?$(".load-more-loading").removeClass("d-none"):a.withLoading($("#products-grid")[0]),a.get(b.products,{search:t,page:e}).then(function(t){var e=t.data;if(P=e.data.has_more||!1,z=e.data.next_page||z+1,o){var a=document.createElement("div");a.innerHTML=e.data.html;var n=$(a).find(".col-md-4");$("#products-grid").append(n)}else $("#products-grid").html(e.data.html||e.html||"");$(".load-more-loading").addClass("d-none"),O=!1,[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(t){return new bootstrap.Tooltip(t)})}).catch(function(t){Botble.handleError(t),O=!1,$(".load-more-loading").addClass("d-none")})}}window.updateQuantity=function(t,e){e=parseInt(e,10),(isNaN(e)||e<1)&&(e=1);var o=$('.cart-item[data-product-id="'.concat(t,'"] input')),a=b.cartUpdate;$httpClient.make().withButtonLoading(o.closest(".input-group").find("button")[0]).post(a,{product_id:t,quantity:e}).then(function(t){var a=t.data;if(a.error)return Botble.showError(a.message||"An error occurred"),void o.val(o.data("last-value")||1);o.data("last-value",e),window.updateCartDisplay(a.data.cart),Botble.showSuccess(a.data.message||"Quantity updated successfully")}).catch(function(t){Botble.handleError(t),o.val(o.data("last-value")||1)})}}),$(document).ready(function(){var t=$("#pos-container"),e={cartAdd:t.data("cart-add-url"),cartUpdate:t.data("cart-update-url"),cartRemove:t.data("cart-remove-url"),cartClear:t.data("cart-clear-url"),cartApplyCoupon:t.data("cart-apply-coupon-url"),cartRemoveCoupon:t.data("cart-remove-coupon-url"),cartUpdateShipping:t.data("cart-update-shipping-url"),cartUpdateManualDiscount:t.data("cart-update-manual-discount-url"),cartRemoveManualDiscount:t.data("cart-remove-manual-discount-url"),products:t.data("products-url"),quickShop:t.data("quick-shop-url"),checkout:t.data("checkout-url"),receipt:t.data("receipt-url")};$(document).on("click","#print-receipt-btn",function(){var t=$(this).data("order-ids")||$(this).data("order-id");t?window.open(e.receipt.replace(":id",t),"_blank"):Botble.showError("Order ID not found")}),$(document).on("click","#new-order-btn",function(){$("#success-modal").modal("hide"),clearCart()}),$("#success-modal").on("hidden.bs.modal",function(){$.ajax({url:t.data("cart-reset-customer-payment-url")||"/pos-pro/cart/reset-customer-payment",method:"POST",success:function(t){t.error||(window.updateCartDisplay(t.data.cart),Botble.showSuccess(t.message))},error:function(t){Botble.handleError(t),$.ajax({url:e.cartClear,method:"POST",success:function(t){t.error||window.updateCartDisplay(t.data.cart)}})}})}),window.clearCart=function(){$.ajax({url:e.cartClear,method:"POST",success:function(t){t.error?Botble.showError(t.message):(window.updateCartDisplay(t.data.cart),"function"==typeof window.clearCustomerDisplay&&window.clearCustomerDisplay(),Botble.showSuccess(t.message))},error:function(t){Botble.handleError(t)}})}}),$(document).ready(function(){var t=$("#pos-container"),e={status:t.data("register-status-url"),open:t.data("register-open-url"),close:t.data("register-close-url")};t.data("register-is-open");function o(t){var e,o,a,n,r,i,s=$("#register-status-badge, #register-status-badge-mobile"),c=$("#register-status-text"),d=$("#register-status-text-mobile");t?(s.removeClass("bg-red").addClass("bg-green"),s.text((null===(e=window.trans)||void 0===e?void 0:e["plugins/pos-pro::pos.open"])||"Open"),c.text((null===(o=window.trans)||void 0===o?void 0:o["plugins/pos-pro::pos.register_open"])||"Register Open"),d.text((null===(a=window.trans)||void 0===a?void 0:a["plugins/pos-pro::pos.click_to_close_register"])||"Click to close register")):(s.removeClass("bg-green").addClass("bg-red"),s.text((null===(n=window.trans)||void 0===n?void 0:n["plugins/pos-pro::pos.closed"])||"Closed"),c.text((null===(r=window.trans)||void 0===r?void 0:r["plugins/pos-pro::pos.register_closed"])||"Register Closed"),d.text((null===(i=window.trans)||void 0===i?void 0:i["plugins/pos-pro::pos.click_to_open_register"])||"Click to open register"))}$(document).on("click","#register-status-btn, #register-status-btn-mobile",function(t){t.preventDefault(),e.status&&$.ajax({url:e.status,method:"GET",success:function(t){var e,o,a,n,r,i,s;t.data&&(t.data,t.data.is_open?(e=t.data,i=window.currencySymbol||"$",s=e.register||{},$("#close-register-start").text(i+((null===(o=s.cash_start)||void 0===o?void 0:o.toFixed(2))||"0.00")),$("#close-register-sales").text(i+((null===(a=s.cash_sales)||void 0===a?void 0:a.toFixed(2))||"0.00")),$("#close-register-expected").text(i+((null===(n=s.expected_cash)||void 0===n?void 0:n.toFixed(2))||"0.00")),$("#close-register-expected").data("expected",s.expected_cash||0),$("#register-actual-cash").val((null===(r=s.expected_cash)||void 0===r?void 0:r.toFixed(2))||0),$("#register-difference").val("0.00"),$("#close-register-modal").modal("show")):$("#open-register-modal").modal("show"))},error:function(t){Botble.handleError(t)}})}),$(document).on("click","#confirm-open-register",function(){var t=$(this),a=parseFloat($("#register-cash-start").val())||0,n=$("#register-open-notes").val();e.open&&$httpClient.make().withButtonLoading(t[0]).post(e.open,{cash_start:a,notes:n}).then(function(t){t.data.error?Botble.showError(t.data.message):(o(!0),$("#open-register-modal").modal("hide"),$("#register-cash-start").val(0),$("#register-open-notes").val(""),Botble.showSuccess(t.data.message))}).catch(function(t){Botble.handleError(t)})}),$(document).on("click","#confirm-close-register",function(){var t=$(this),a=parseFloat($("#register-actual-cash").val())||0,n=$("#register-close-notes").val();e.close&&$httpClient.make().withButtonLoading(t[0]).post(e.close,{actual_cash:a,notes:n}).then(function(t){t.data.error?Botble.showError(t.data.message):(o(!1),$("#close-register-modal").modal("hide"),$("#register-actual-cash").val(0),$("#register-close-notes").val(""),Botble.showSuccess(t.data.message))}).catch(function(t){Botble.handleError(t)})}),$(document).on("input","#register-actual-cash",function(){var t=(parseFloat($(this).val())||0)-(parseFloat($("#close-register-expected").data("expected"))||0);$("#register-difference").val(t.toFixed(2)),t>=0?$("#register-difference").removeClass("text-danger").addClass("text-success"):$("#register-difference").removeClass("text-success").addClass("text-danger")}),e.status&&$.ajax({url:e.status,method:"GET",success:function(t){t.data&&o(t.data.is_open)}})}),$(document).ready(function(){var t=$("#pos-container"),e=t.data("get-variation-url")||"/pos-pro/get-variation",o=t.data("product-price-url")||"/pos-pro/product-price";$(document).on("change",'.quick-shop-form .variation-select, .attribute-swatch-item input[type="radio"]',function(){var t=$(this).closest("form"),a=t.find(".variation-info"),n=t.find(".variation-price"),r=t.find(".variation-stock"),i={};t.find("select.variation-select").each(function(){var t=$(this).data("attribute-id"),e=$(this).val();if(e){i[t]=e;var o=$(this).find("option:selected").text().trim(),a=$(this).closest(".attribute-swatches-wrapper").find("label").text().replace(":","").trim();$(this).data("attribute-set-title",a),$(this).data("attribute-title",o)}}),t.find('input[type="radio"]:checked').each(function(){var t=$(this).data("attribute-id"),e=$(this).val();if(e){i[t]=e;var o=$(this).closest("label").find(".attribute-swatch-text").text().trim()||$(this).closest("label").find(".attribute-swatch-item-tooltip").text().trim(),a=$(this).closest(".attribute-swatches-wrapper").find("h4.attribute-name").text().replace(":","").trim();$(this).data("attribute-set-title",a),$(this).data("attribute-title",o)}});var s=t.find(".attribute-swatches-wrapper").length,c=Object.keys(i).length===s,d=t.data("product-id");$.ajax({url:e,method:"GET",data:{product_id:d,attributes:i},success:function(e){if(e.data&&e.data.availableAttributes&&function(t,e,o){t.find(".attribute-swatches-wrapper").each(function(){var t=$(this).find(".variation-select").data("attribute-id")||$(this).find('input[type="radio"]').first().data("attribute-id");if(!o[t]&&e[t]){var a=e[t];$(this).find("select.variation-select option").each(function(){var t=$(this).attr("value");t&&!a.includes(parseInt(t))?$(this).prop("disabled",!0):$(this).prop("disabled",!1)}),$(this).find(".attribute-swatch-item").each(function(){var t=$(this).find('input[type="radio"]').val();t&&!a.includes(parseInt(t))?($(this).addClass("disabled"),$(this).find('input[type="radio"]').prop("disabled",!0)):($(this).removeClass("disabled"),$(this).find('input[type="radio"]').prop("disabled",!1))})}})}(t,e.data.availableAttributes,i),e.data&&e.data.variation){var s=e.data.variation;t.find('input[name="product_id"]').val(s.product.id),$.get("".concat(o,"?product_id=").concat(s.product.id),function(t){n.html(t.data)}),s.product.with_storehouse_management?s.product.quantity>0?r.html('<span class="badge bg-green-lt">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3l8 4.5l0 9l-8 4.5l-8 -4.5l0 -9l8 -4.5" /><path d="M12 12l8 -4.5" /><path d="M12 12l0 9" /><path d="M12 12l-8 -4.5" /></svg> '.concat(window.trans.in_stock||"In Stock",": ").concat(s.product.quantity,"\n                            </span>")):r.html('<span class="badge bg-red-lt">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v4" /><path d="M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z" /><path d="M12 16h.01" /></svg> '.concat(window.trans.out_of_stock||"Out of Stock","\n                            </span>")):r.html('<span class="badge bg-green-lt">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3l8 4.5l0 9l-8 4.5l-8 -4.5l0 -9l8 -4.5" /><path d="M12 12l8 -4.5" /><path d="M12 12l0 9" /><path d="M12 12l-8 -4.5" /></svg> '.concat(window.trans.in_stock||"In Stock","\n                        </span>")),a.removeClass("d-none")}else c&&a.addClass("d-none")},error:function(t){Botble.handleError(t),a.addClass("d-none")}}),Object.keys(i).length||a.addClass("d-none")})})})();
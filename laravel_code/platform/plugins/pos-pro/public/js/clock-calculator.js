(()=>{"use strict";!function(){function e(){var e=(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),t=document.getElementById("pos-clock-time"),a=document.getElementById("pos-clock-time-mobile");t&&(t.textContent=e),a&&(a.textContent=e)}e(),setInterval(e,1e3);var t={displayValue:"0",firstOperand:null,waitingForSecondOperand:!1,operator:null,init:function(){this.bindEvents(),this.resetOnModalOpen()},bindEvents:function(){var e=this;document.querySelectorAll("[data-calc]").forEach(function(t){t.addEventListener("click",function(t){switch(t.currentTarget.dataset.calc){case"num":e.inputDigit(t.currentTarget.dataset.num);break;case"op":e.handleOperator(t.currentTarget.dataset.op);break;case"equals":e.handleOperator("=");break;case"clear":e.clear();break;case"negate":e.negate();break;case"percent":e.percent()}})}),document.addEventListener("keydown",function(t){var a=document.getElementById("calculator-modal");a&&a.classList.contains("show")&&(t.key>="0"&&t.key<="9"?e.inputDigit(t.key):"."===t.key?e.inputDigit("."):"+"===t.key?e.handleOperator("+"):"-"===t.key?e.handleOperator("-"):"*"===t.key?e.handleOperator("*"):"/"===t.key?(t.preventDefault(),e.handleOperator("/")):"Enter"===t.key||"="===t.key?(t.preventDefault(),e.handleOperator("=")):"Escape"===t.key||"c"===t.key||"C"===t.key?e.clear():"Backspace"===t.key?e.backspace():"%"===t.key&&e.percent())})},resetOnModalOpen:function(){var e=this,t=document.getElementById("calculator-modal");t&&t.addEventListener("show.bs.modal",function(){e.clear()})},inputDigit:function(e){if(this.waitingForSecondOperand)this.displayValue="."===e?"0.":e,this.waitingForSecondOperand=!1;else if("."===e){if(this.displayValue.includes("."))return;this.displayValue+="."}else this.displayValue="0"===this.displayValue?e:this.displayValue+e;this.updateDisplay()},handleOperator:function(e){var t=parseFloat(this.displayValue);if(this.operator&&this.waitingForSecondOperand)return this.operator=e,void this.updateOperatorHighlight(e);if(null!==this.firstOperand||isNaN(t)){if(this.operator){var a=this.calculate(this.firstOperand,t,this.operator);this.displayValue=this.formatResult(a),this.firstOperand=a}}else this.firstOperand=t;this.waitingForSecondOperand=!0,this.operator="="===e?null:e,this.updateOperatorHighlight(e),this.updateDisplay()},calculate:function(e,t,a){switch(a){case"+":return e+t;case"-":return e-t;case"*":return e*t;case"/":return 0!==t?e/t:"Error";default:return t}},formatResult:function(e){if("Error"===e||isNaN(e)||!isFinite(e))return"Error";var t=parseFloat(e.toPrecision(12));return String(t)},clear:function(){this.displayValue="0",this.firstOperand=null,this.waitingForSecondOperand=!1,this.operator=null,this.updateOperatorHighlight(null),this.updateDisplay()},backspace:function(){this.waitingForSecondOperand||(this.displayValue=this.displayValue.length>1?this.displayValue.slice(0,-1):"0",this.updateDisplay())},negate:function(){var e=parseFloat(this.displayValue);0!==e&&(this.displayValue=String(-e),this.updateDisplay())},percent:function(){var e=parseFloat(this.displayValue);this.displayValue=String(e/100),this.updateDisplay()},updateDisplay:function(){var e=document.getElementById("calculator-display");if(e){var t=this.displayValue;if("Error"!==t&&!isNaN(parseFloat(t))){var a=t.split(".");a[0]=a[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t=a.join(".")}e.textContent=t,t.length>9?e.style.fontSize="2rem":t.length>7?e.style.fontSize="2.5rem":e.style.fontSize="3rem"}},updateOperatorHighlight:function(e){if(document.querySelectorAll(".calc-op").forEach(function(e){e.classList.remove("active")}),e&&"="!==e){var t=document.querySelector('[data-op="'.concat(e,'"]'));t&&t.classList.add("active")}}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){return t.init()}):t.init()}()})();